<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>OmniLink Solutions â€” Smart Service Network</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg1:#0b0a18; --ink:#f6f7fb; --muted:#bfc3e0;
  --brand:#8a5cff; --brand2:#6a4cff; --chip:#231f41; --ok:#23d5ab;
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:Poppins,system-ui;background:radial-gradient(1100px 700px at 20% -10%,#1a1631 0%,#0b0a18 65%);
  color:var(--ink);min-height:100vh;overflow-x:hidden;
}
header{display:flex;justify-content:space-between;align-items:center;width:min(1200px,94vw);margin:24px auto}
.badge{width:60px;height:60px;border-radius:16px;display:grid;place-items:center;font-weight:900;background:linear-gradient(135deg,var(--brand),var(--brand2));color:#0b0620}
.btn{
  background:linear-gradient(135deg,var(--brand),var(--brand2));color:#0b0620;border:none;
  font-weight:700;padding:10px 16px;border-radius:12px;cursor:pointer;transition:.25s;
  box-shadow:0 8px 22px rgba(0,0,0,.35)
}
.btn:hover{transform:translateY(-2px);opacity:.95}
.hero{text-align:center;margin-top:18px}
.hero h2{font-size:clamp(22px,3.3vw,36px)}
.hero p{color:var(--muted);margin-top:6px}
.section{width:min(1200px,94vw);margin:34px auto}
.section h3{text-align:center;margin-bottom:12px}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:14px}
.bubble{
  background:#231f41;color:#fff;padding:12px;border-radius:999px;text-align:center;font-weight:700;cursor:pointer;transition:.25s
}
.bubble:hover{background:linear-gradient(135deg,var(--brand),var(--brand2));color:#0b0620;transform:scale(1.06)}
footer{text-align:center;color:var(--muted);margin:40px 0 26px;font-size:14px}

/* Chat */
.chat{
  position:fixed;bottom:100px;right:20px;width:360px;max-height:560px;display:none;flex-direction:column;
  background:#18152f;border-radius:16px;padding:14px;border:1px solid #ffffff1a;box-shadow:0 8px 22px rgba(0,0,0,.4);z-index:60
}
.chat-log{flex:1;overflow-y:auto;font-size:14px}
.msg{background:#2b2650;padding:9px 11px;border-radius:12px;margin:6px 0;max-width:82%}
.bot{background:linear-gradient(135deg,var(--brand),var(--brand2));color:#0b0620}
.user{align-self:flex-end;background:#332e5a}
.input{border:none;border-radius:10px;padding:10px;background:#2b2650;color:#fff;margin-top:6px}

canvas#confetti{position:fixed;inset:0;pointer-events:none;z-index:100}
</style>
</head>
<body>
<canvas id="confetti"></canvas>

<header>
  <div style="display:flex;align-items:center;gap:12px">
    <div class="badge">OL</div>
    <h1>OmniLink Solutions</h1>
  </div>
  <div style="display:flex;gap:10px">
    <button class="btn" onclick="location.href='contractor.html'">Contractors</button>
    <button class="btn" onclick="location.href='login.html'">Dashboard</button>
  </div>
</header>

<section class="hero">
  <h2>Choose the service you need today!</h2>
  <p>All trades. All industries. One intelligent network.</p>
</section>

<div id="catalog"></div>

<div class="chat" id="chat">
  <div style="font-weight:700;margin-bottom:6px">ðŸ’¬ Omni Assistant</div>
  <div id="log" class="chat-log"></div>
  <input id="inp" class="input" placeholder="Type hereâ€¦ (Enter to send)" autocomplete="off">
</div>

<footer>Â© 2025 OmniLink Solutions â€” Smart, Simple & Affordable for Every Service</footer>

<script>
/* ============= Confetti ============= */
const conf = document.getElementById('confetti'), ctx = conf.getContext('2d');
function size(){ conf.width = innerWidth; conf.height = innerHeight; } size(); addEventListener('resize', size);
function confettiBurst(){
  const colors=['#8a5cff','#6a4cff','#23d5ab','#7ee6d5','#ffd166'];
  const parts=[...Array(110)].map(()=>({x:innerWidth/2,y:innerHeight-20,r:3+Math.random()*5,dx:-7+Math.random()*14,dy:-11-Math.random()*7,c:colors[Math.floor(Math.random()*colors.length)],life:120}));
  let t=0;(function draw(){ctx.clearRect(0,0,conf.width,conf.height);for(const p of parts){ctx.beginPath();ctx.arc(p.x,p.y,p.r,0,2*Math.PI);ctx.fillStyle=p.c;ctx.fill();p.x+=p.dx;p.y+=p.dy;p.dy+=0.22} if(++t<120) requestAnimationFrame(draw);})();
  setTimeout(()=>ctx.clearRect(0,0,conf.width,conf.height),2000);
}

/* ============= Catalog (lots of services) ============= */
const CATEGORIES = {
 "Home & Maintenance": ["Plumbing","Electrical","Roofing","Painting","Carpentry","Handyman","Flooring","Pest Control","Landscaping","Solar Installation","Security Systems","Waterproofing","Gutter Cleaning","Window Cleaning","Appliance Repair","Air Conditioning"],
 "Property & Real Estate": ["Property Sales","Rentals","Valuations","Estate Management","Developments","Architecture","Interior Design","Land Surveying"],
 "Business & Consulting": ["Accounting","Tax Advisory","Legal","Branding","Marketing","Courier Services","Staffing","IT Support","Web Development","Social Media","Cybersecurity"],
 "Automotive": ["Mechanic","Panel Beating","Tyre Fitment","Car Wash","Towing","Auto Electrician","Battery Replacement","Detailing"],
 "Health & Wellness": ["Personal Trainer","Massage Therapy","Nutrition Coach","Yoga Instructor","Physio","Spa Services"],
 "Specialty & Events": ["Event Planning","Photography","Catering","Decor","Sound & Lighting","Security Personnel","Cleaning Crew"]
};
const catalog = document.getElementById('catalog');
for(const [k,list] of Object.entries(CATEGORIES)){
  const sec = document.createElement('section'); sec.className='section';
  sec.innerHTML = `<h3>${k}</h3><div class="grid">${list.map(s=>`<div class="bubble" onclick="startChat('${s}')">${s}</div>`).join('')}</div>`;
  catalog.appendChild(sec);
}

/* ============= Chatbot ============= */
const chat = document.getElementById('chat'), log = document.getElementById('log'), inp=document.getElementById('inp');
let step=0, lead={}, currentService="", contractorPick=null;

function say(txt, cls='bot'){ const d=document.createElement('div'); d.className='msg '+cls; d.textContent=txt; log.appendChild(d); log.scrollTop=log.scrollHeight; }
function ask(txt){ say(txt,'bot'); }
function startChat(service){
  currentService=service; step=0; contractorPick=null; lead={service};
  log.innerHTML=''; chat.style.display='flex';
  ask(`Hi ðŸ‘‹ Looking for *${service}* help? Great choice!`);
  setTimeout(()=>ask("What's your full name?"),400);
}
inp.addEventListener('keydown', e=>{
  if(e.key!=='Enter') return;
  const v=inp.value.trim(); if(!v) return;
  say(v,'user'); inp.value='';
  switch(step){
    case 0: lead.name=v; ask("ðŸ“ž Best phone number to reach you?"); step++; break;
    case 1: lead.phone=v; ask("ðŸ“ Which area/city are you in?"); step++; break;
    case 2: lead.area=v; ask("ðŸ“ Describe the issue briefly."); step++; break;
    case 3: lead.desc=v; listContractors(); break;
    case 4: handleContractorChoice(v); break;
  }
});

function listContractors(){
  const db = JSON.parse(localStorage.getItem('omni_contractors')||'{}');
  const candidates = (db[currentService]||[]).filter(x=>!lead.area || (x.area||'').toLowerCase().includes(lead.area.toLowerCase()));
  if(candidates.length){
    lead.candidates=candidates.map((c,i)=>({i:i+1,name:c.name,id:c.id,area:c.area,rating:c.rating||'4.8'}));
    ask("Here are available contractors in your area. Reply with a number to choose:");
    lead.candidates.slice(0,10).forEach(c=>say(`${c.i}. ${c.name} â€” ${c.area} â­${c.rating}`));
    ask("Or type 'any' and weâ€™ll assign the best available."); step=4;
  }else{
    ask("Weâ€™ll assign a trusted provider for you and contact you shortly.");
    finishLead(null);
  }
}
function handleContractorChoice(v){
  if(/^any$/i.test(v)) { finishLead(null); return; }
  const n = parseInt(v,10);
  const found = lead.candidates?.find(c=>c.i===n);
  finishLead(found || null);
}

function finishLead(chosen){
  contractorPick=chosen;
  const now = new Date().toISOString();
  const store = (k,obj)=>localStorage.setItem(k,JSON.stringify(obj));

  // Leads DB
  const leads = JSON.parse(localStorage.getItem('omni_leads')||'[]');
  const id = 'L'+Math.random().toString(36).slice(2,8);
  const payload = { id, createdAt:now, status:'new', ...lead, contractorId: chosen?.id || null, contractorName: chosen?.name||null };
  leads.push(payload); store('omni_leads',leads);

  // If assigned, also push to contractor's jobs
  if(chosen?.id){
    const jobs = JSON.parse(localStorage.getItem('omni_jobs')||'{}');
    jobs[chosen.id] = jobs[chosen.id] || [];
    jobs[chosen.id].push({leadId:id, ...payload});
    store('omni_jobs', jobs);
  }

  // Optional Telegram (leave blank, fill later)
  const TELEGRAM_BOT_TOKEN = "";      // <-- add later
  const TELEGRAM_CHAT_ID  = "";       // <-- add later
  if(TELEGRAM_BOT_TOKEN && TELEGRAM_CHAT_ID){
    fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`,{
      method:'POST',headers:{'Content-Type':'application/json'},
      body:JSON.stringify({chat_id:TELEGRAM_CHAT_ID,parse_mode:'Markdown',
        text:`ðŸ§° *NEW LEAD*\nService: ${lead.service}\nðŸ‘¤ ${lead.name}\nðŸ“ž ${lead.phone}\nðŸ“ ${lead.area}\nðŸ“ ${lead.desc}\nAssigned: ${chosen?chosen.name:'Auto-assigned'}\nID: ${id}`})
    }).catch(()=>{});
  }

  say("âœ… Thank you! Your request has been submitted. Weâ€™ll be in touch shortly.");
  confettiBurst();
  setTimeout(()=>{ chat.style.display='none'; }, 2000); // auto-close
}
</script>
</body>
</html>
